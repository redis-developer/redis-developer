<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-howtos/antipatterns/index-antipatterns">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Redis Anti-Patterns Every Developer Should Avoid | The Home of Redis Developers</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://developer.redis.com/img/redis-hero-image.jpg"><meta data-rh="true" name="twitter:image" content="https://developer.redis.com/img/redis-hero-image.jpg"><meta data-rh="true" property="og:url" content="https://developer.redis.com/howtos/antipatterns/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Redis Anti-Patterns Every Developer Should Avoid | The Home of Redis Developers"><meta data-rh="true" name="description" content="antipattern"><meta data-rh="true" property="og:description" content="antipattern"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://developer.redis.com/howtos/antipatterns/"><link data-rh="true" rel="alternate" href="https://developer.redis.com/howtos/antipatterns/" hreflang="en"><link data-rh="true" rel="alternate" href="https://developer.redis.com/howtos/antipatterns/" hreflang="x-default"><script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-W8Z6BLQ",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script><link rel="stylesheet" href="/assets/css/styles.b5561ee1.css">
<link rel="preload" href="/assets/js/runtime~main.bb8e0787.js" as="script">
<link rel="preload" href="/assets/js/main.953e99e4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W8Z6BLQ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:rgb(210, 215, 254);color:rgb(22 31 49)" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><div class="announcement-bar"><a href="https://redis.com/blog/introducing-redis-7-2/" target="_blank" rel="noopener"><span>Announcing Redis 7.2 and Enhanced Vector DB</span> <span style="margin-left:1rem">Learn more</span> <span style="margin-left:0.25rem">â†’</span></a></div></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><div id="redis-sitesearch" class="redis-sitesearch redis-sitesearch-inline"><input class="redis-sitesearch-input"><div class="redis-sitesearch-result-list-wrapper"><ul class="redis-sitesearch-result-list"></ul><div class="redisearch-logo"></div></div></div></div><a class="navbar__item navbar__link" href="/howtos/quick-start">Get started</a><a href="https://launchpad.redis.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Redis Launchpad<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://redis.com/try-free/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Try Free<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_ToTc themedImage--dark_i4oU"></a><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Home</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/howtos/quick-start">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/create">Create</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/develop">Develop</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/explore">Explore</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/operate/observability/redisdatasource">Operate</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/howtos/quick-start/cheat-sheet">HowTos &amp; Tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/quick-start/cheat-sheet">Cheat sheet</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/howtos/solutions">Solutions</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/leaderboard">How to build a Real-Time Leaderboard app Using Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/ratelimiting">How to build a Rate Limiter using Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/caching">How to cache REST API responses Using Redis &amp; NodeJS</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/howtos/moviesdatabase/install">How to list &amp; search Movies database using Redis Stack</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/chatapp">How to build a Chat application using Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/frauddetection">How to build a Fraud Detection System using Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/nlp">Building a Pipeline for Natural Language Processing using RedisGears</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/redisai/bert-qa-benchmarking-with-redisai-and-redisgears">Benchmarks for BERT Large Question Answering inference for RedisAI and RedisGears</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/hackernews">How to build a HackerNews Clone using Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/howtos/antipatterns/">Redis Anti-Patterns Every Developer Should Avoid</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/socialnetwork/">Building a Social Network Application using Redis Stack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/security/">How to Use SSL/TLS With Redis Enterprise</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/analytics">Building an Analytics dashboard app using Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/popupstore">Building a Popup Store application using Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/herokunodejs">How to build a NodeJS based application on Heroku using Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/herokupython">How to build a Python based application on Heroku using Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/herokujava">How to build a Java based application on Heroku using Redis</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/community/">Get Involved</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ebooks/8-nosql-data-modeling-patterns">E-books</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HowTos &amp; Tutorials</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Redis Anti-Patterns Every Developer Should Avoid</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Redis Anti-Patterns Every Developer Should Avoid</h1></header><div class="docAuthors"><hr><div class="authorByline_VoxI"><img class="authorProfileImage_URwT" src="/img/profile_pic_ajeet_raina.jpg" alt="Profile picture for Ajeet Raina"><div><div class="authorLabel_a70t">Author:</div><div><a href="https://twitter.com/ajeetsraina" target="_blank">Ajeet Raina</a>, <!-- -->Former Developer Growth Manager at Redis</div></div></div><hr></div><p><img loading="lazy" alt="antipattern" src="/assets/images/antipattern-8be69360b45966c852b6ee9070a11062.png" width="1804" height="1208" class="img_ev3q"></p><p>Developers donâ€™t just use Redis, they love it. <a href="https://insights.stackoverflow.com/survey/2021#technology-most-loved-dreaded-and-wanted" target="_blank" rel="noopener noreferrer">Stack Overflowâ€™s annual Developer Survey 2021</a> has ranked Redis as the Most Loved Database platform for the fifth years running! But it is equally important to understand that Redis defaults are not the best for everyone. Millions of developers uses Redis due to its speed and performance, however it is important to make sure that it is being used properly.</p><p>&quot;Antipatterns&quot; basically refers to those practices and solutions that might seem to be a good fit initially but when it comes to implementation phase, it makes your code much more complex. Let us look at the top Redis anti-patterns to avoid:</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-large-databases-running-on-a-single-shardredis-instance">1. Large databases running on a single shard/Redis instance<a class="hash-link" href="#1-large-databases-running-on-a-single-shardredis-instance" title="Direct link to heading">â€‹</a></h3><p>With large databases running on a single shard/Redis instance, there are chances that the fail over, backup and recovery all will take longer. Hence, itâ€™s always recommended to keep shards to recommended sizes. General conservative rule of thumb is 25Gb or 25K Ops/Second.</p><p>Redis Cloud recommends to shard if you have more than 25 GB of data and a high number of operations. Another aspect is if you have above 25,000 operations per second, then sharding can improve performance. With less number of operations/second, it can handle up to 50GB of data too.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="examples-1---redis-py">Examples #1 - redis-py<a class="hash-link" href="#examples-1---redis-py" title="Direct link to heading">â€‹</a></h3><p>Let us look at the redis-py that uses a connection pool to manage connections to a Redis server. By default, each Redis instance you create will in turn create its own connection pool. You can override this behavior and use an existing connection pool by passing an already created connection pool instance to the connection_pool argument of the Redis class. You may choose to do this in order to implement client side sharding or have fine-grain control of how connections are managed.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> pool </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> redis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ConnectionPool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">host</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;localhost&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">6379</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> db</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> r </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> redis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Redis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">connection_pool</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">pool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-connecting-directly-to-redis-instances">2. Connecting directly to Redis instances<a class="hash-link" href="#2-connecting-directly-to-redis-instances" title="Direct link to heading">â€‹</a></h3><p>With a large number of clients, a reconnect flood will be able to simply overwhelm a single threaded Redis process and force a failover. Hence, it is recommended that you should use the right tool that allows you to reduce the number of open connections to your Redis server.</p><p><a href="https://docs.redis.com/latest/rs/administering/designing-production/networking/multiple-active-proxy/" target="_blank" rel="noopener noreferrer">Redis Enterprise DMC proxy</a> allows you to reduce the number of connections to your cache server by acting as a proxy. There are other 3rd party tool like <a href="https://github.com/twitter/twemproxy" target="_blank" rel="noopener noreferrer">Twemproxy</a>. It is a fast and lightweight proxy server that allows you to reduce the number of open connections to your Redis server. It was built primarily to reduce the number of connections to the caching servers on the backend. This, together with protocol pipelining and sharding enables you to horizontally scale your distributed caching architecture.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-more-than-one-secondary-shard-redis-oss">3. More than one secondary shard (Redis OSS)<a class="hash-link" href="#3-more-than-one-secondary-shard-redis-oss" title="Direct link to heading">â€‹</a></h3><p>Redis OSS uses a shard-based quorum. It&#x27;s advised to use at least 3 copies of the data (2 replica shards per master shard) in order to be protected from split-brain situations. In nutshell, Redis OSS solves the quorum challenge by having an odd number of shards (primary + 2 replicas).</p><p>Redis Cloud solves the quorum challenge with an odd number of nodes. Redis Cloud avoids a split-brain situation with only 2 copies of the data, which is more cost-efficient. In addition, the so-called â€˜quorum-only node&#x27; can be used to bring a cluster up to an odd number of nodes if an additional, not necessary data node would be too expensive.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-performing-single-operation">4. Performing single operation<a class="hash-link" href="#4-performing-single-operation" title="Direct link to heading">â€‹</a></h3><p>Performing several operations serially increases connection overhead. Instead, use <a href="https://redis.io/topics/pipelining" target="_blank" rel="noopener noreferrer">Redis Pipelining</a>. Pipelining is the process of sending multiple messages down the pipe without waiting on the reply from each - and (typically) processing the replies later when they come in.</p><p>Pipelining is completely a client side implementation. It is aimed at solving response latency issues in high network latency environments. So, the lesser the amount of time spent over the network in sending commands and reading responses, the better. This is effectively achieved by buffering. The client may (or may not) buffer the commands at the TCP stack (as mentioned in other answers) before they are sent to the server. Once they are sent to the server, the server executes them and buffers them on the server side. The benefit of the pipelining is a drastically improved protocol performance. The speedup gained by pipelining ranges from a factor of five for connections to localhost up to a factor of at least one hundred over slower internet connections.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5-caching-keys-without-ttl">5. Caching keys without TTL<a class="hash-link" href="#5-caching-keys-without-ttl" title="Direct link to heading">â€‹</a></h3><p>Redis functions primarily as a key-value store. It is possible to set timeout values on these keys. Said that, a timeout expiration automatically deletes the key. Additionally, when we use commands that delete or overwrite the contents of the key, it will clear the timeout. Redis TTL command is used to get the remaining time of the key expiry in seconds. TTL returns the remaining time to live of a key that has a timeout. This introspection capability allows a Redis client to check how many seconds a given key will continue to be part of the dataset.Keys will accumulate and end up being evicted. Hence, it is recommended to set TTLs on all caching keys.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6-endless-redis-replication-loop">6. Endless Redis Replication Loop<a class="hash-link" href="#6-endless-redis-replication-loop" title="Direct link to heading">â€‹</a></h3><p>When attempting to replicate a very large active database over a slow or saturated link, replication never finishes due to the continuous updates. Hence, it is recommended to tune the slave and client buffers to allow for slower replication. Check out <a href="https://redis.com/blog/the-endless-redis-replication-loop-what-why-and-how-to-solve-it/" target="_blank" rel="noopener noreferrer">this detailed blog</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="7-hot-keys">7. Hot Keys<a class="hash-link" href="#7-hot-keys" title="Direct link to heading">â€‹</a></h3><p>Redis can easily become the core of your appâ€™s operational data, holding valuable and frequently accessed information. However, if you centralize the access down to a few pieces of data accessed constantly, you create what is known as a hot-key problem. In a Redis cluster, the key is actually what determines where in the cluster that data is stored. The data is stored in one single, primary location based off of hashing that key. So, when you access a single key over and over again, youâ€™re actually accessing a single node/shard over and over again. Letâ€™s put it another wayâ€”if you have a cluster of 99 nodes and you have a single key that gets a million requests in a second, all million of those requests will be going to a single node, not spread across the other 98 nodes.</p><p>Redis even provides tools to find where your hot keys are located. Use redis-cli with the â€“hotkeys argument alongside any other arguments you need to connect:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $ redis-cli --hotkeys</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When possible, the best defence is to avoid the development pattern that is creating the situation. Writing the data to multiple keys that reside in different shards will allow you to access the same data more frequently. In nutshell, having specific keys that are accessed with every client operation. Hence, it&#x27;s recommended to shard out hot keys using hashing algorithms. You can set policy to LFU and run redis-cli --hotkeys to determine.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="8-using-keys-command">8. Using Keys command<a class="hash-link" href="#8-using-keys-command" title="Direct link to heading">â€‹</a></h3><p>In Redis, the KEYS command can be used to perform exhaustive pattern matching on all stored keys. This is not advisable, as running this on an instance with a large number of keys could take a long time to complete, and will slow down the Redis instance in the process. In the relational world, this is equivalent to running an unbound query (SELECT...FROM without a WHERE clause). Execute this type of operation with care, and take necessary measures to ensure that your tenants are not performing a KEYS operation from within their application code. Use SCAN, which spreads the iteration over many calls, not tying up your whole server at one time.</p><p>Scaning keyspace by keyname is an extremely slow operation and will run O(N) with N being the number of keys. It is recommended to use Redis Search to return information based on the contents of the data instead of iterating through the key space.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> FT.SEARCH orders </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;@make: ford @model: explorer&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 2SQL: SELECT * FROM orders WHERE </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">make</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ford AND </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">model</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">explorer&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="9-running-ephemeral-redis-as-a-primary-database">9. Running Ephemeral Redis as a primary database<a class="hash-link" href="#9-running-ephemeral-redis-as-a-primary-database" title="Direct link to heading">â€‹</a></h3><p>Redis is often used as a primary storage engine for applications. Unlike using Redis as a cache, using Redis as a primary database requires two extra features to be effective. Any primary database should really be highly available. If a cache goes down, then generally your application is in a brown-out state. If a primary database goes down, your application also goes down. Similarly, if a cache goes down and you restart it empty, thatâ€™s no big deal. For a primary database, though, thatâ€™s a huge deal. Redis can handle these situations easily, but they generally require a different configuration than running as a cache. Redis as a primary database is great, but youâ€™ve got to support it by turning on the right features.</p><p>With Redis open source, you need to set up Redis Sentinel for high availability. In Redis Cloud, itâ€™s a core feature that you just need to turn on when creating the database. As for durability, both Redis Cloud and open source Redis provide durability through AOF or snapshotting so your instance(s) start back up the way you left them.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="10-storing-json-blobs-in-a-string">10. Storing JSON blobs in a string<a class="hash-link" href="#10-storing-json-blobs-in-a-string" title="Direct link to heading">â€‹</a></h3><p>Microservices written in several languages may not marshal/unmarshal JSON in a consistent manner. Application logic will be required to lock/watch a key for atomic updates. JSON manipulation is often a very compute costly operation. Hence, it is recommended to use HASH data structure and also Redis JSON.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11-translating-a-table-or-json-to-a-hash-without-considering-query-pattern">11. Translating a table or JSON to a HASH without considering query pattern<a class="hash-link" href="#11-translating-a-table-or-json-to-a-hash-without-considering-query-pattern" title="Direct link to heading">â€‹</a></h3><p>The only query mechanism is a SCAN which requires reading the data structure and limits filtering to the MATCH directive. It is recommended to store the table or JSON as a string. Break out the indexes into reverse indexes using a SET or SORTED SET and point back to the key for the string.
Using SELECT command and multiple databases inside one Redis instance</p><p>The usage of SELECT and multiple databases inside one Redis instance was mentioned as an anti-pattern by Salvatore (the creator of Redis). It is recommended to use a dedicated Redis instance for each database need. This is especially true in microservice architectures where client applications might step on each other&#x27;s toes (noisy neighbor, database setup/teardown impact, maintenance, upgrade, ...)</p><p>The Redis Time Series module provides a direct compete to time series databases. But if the only query is based on ordering, it&#x27;s unnecessary complexity. Hence, it is recommended to use a SORTED SET with a score of 0 for every value. The values are appended. Or use a timestamp for the score for simple time based queries</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">â€‹</a></h3><ul><li><a href="https://redis.com/redis-best-practices" target="_blank" rel="noopener noreferrer">Redis Best Practices</a></li><li><a href="https://redis.com/blog/7-redis-worst-practices/" target="_blank" rel="noopener noreferrer">7 Redis Worst Practices</a></li><li><a href="https://www.youtube.com/watch?v=V532pU-7zW8" target="_blank" rel="noopener noreferrer">Redis Anti-Patterns Video</a></li><li><a href="https://developer.redis.com/develop/java/" target="_blank" rel="noopener noreferrer">Java and Redis</a></li></ul><h2></h2><div><a href="https://launchpad.redis.com" target="_blank" rel="noopener" class="link"><img loading="lazy" src="/img/launchpad.png" class="thumb img_ev3q" alt="Redis Launchpad"></a></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/antipatterns/index-antipatterns.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-11-16T16:38:00.000Z">Nov 16, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/howtos/hackernews"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">How to build a HackerNews Clone using Redis</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/howtos/socialnetwork/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Building a Social Network Application using Redis Stack</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-large-databases-running-on-a-single-shardredis-instance" class="table-of-contents__link toc-highlight">1. Large databases running on a single shard/Redis instance</a></li><li><a href="#examples-1---redis-py" class="table-of-contents__link toc-highlight">Examples #1 - redis-py</a></li><li><a href="#2-connecting-directly-to-redis-instances" class="table-of-contents__link toc-highlight">2. Connecting directly to Redis instances</a></li><li><a href="#3-more-than-one-secondary-shard-redis-oss" class="table-of-contents__link toc-highlight">3. More than one secondary shard (Redis OSS)</a></li><li><a href="#4-performing-single-operation" class="table-of-contents__link toc-highlight">4. Performing single operation</a></li><li><a href="#5-caching-keys-without-ttl" class="table-of-contents__link toc-highlight">5. Caching keys without TTL</a></li><li><a href="#6-endless-redis-replication-loop" class="table-of-contents__link toc-highlight">6. Endless Redis Replication Loop</a></li><li><a href="#7-hot-keys" class="table-of-contents__link toc-highlight">7. Hot Keys</a></li><li><a href="#8-using-keys-command" class="table-of-contents__link toc-highlight">8. Using Keys command</a></li><li><a href="#9-running-ephemeral-redis-as-a-primary-database" class="table-of-contents__link toc-highlight">9. Running Ephemeral Redis as a primary database</a></li><li><a href="#10-storing-json-blobs-in-a-string" class="table-of-contents__link toc-highlight">10. Storing JSON blobs in a string</a></li><li><a href="#11-translating-a-table-or-json-to-a-hash-without-considering-query-pattern" class="table-of-contents__link toc-highlight">11. Translating a table or JSON to a HASH without considering query pattern</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><svg width="785" height="158" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="shape"><defs><path d="M786.344 392.459c-41.822 22.164-258.313 110.84-305.056 135.477-46.742 24.637-72.163 23.812-108.246 6.57-36.082-17.24-267.334-111.664-309.156-131.377-41.822-19.713-42.642-33.657-1.64-49.271C103.25 338.265 332.86 247.94 381.243 229.875c48.383-18.065 65.604-18.065 106.605-2.473 41.003 15.614 256.674 100.996 297.676 115.785 41.002 14.791 42.642 27.912.82 49.273v-.001z" id="a"></path><mask id="b" maskContentUnits="userSpaceOnUse" maskUnits="objectBoundingBox" x="0" y="0" width="785" height="331" fill="#fff"><use xlink:href="#a"></use></mask></defs><use mask="url(#b)" xlink:href="#a" transform="translate(-32 -216)" stroke="#465282" stroke-width="4" fill="none" fill-rule="evenodd" stroke-dasharray="3.637"></use></svg><img src="/img/code-2.png" class="code" alt=""><div class="row"><div class="col col--3"><div class="footer__logo-ctr"><span class="footer__logo-tagline">Made with &lt;/&gt; by</span><a href="https://redis.com/" target="_blank" rel="noopener" class="footerLogoLink_fGS1"><img loading="lazy" class="footer__logo" alt="Redis logo" src="/img/redis_logo_red_white_rgb.svg"></a></div></div><div class="col col--9"><div class="row footer__links"><div class="col col--4 footer__col"><h4 class="footer__title">Get Started</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/develop/">Develop</a></li><li class="footer__item"><a href="https://redis.com/redis-best-practices/introduction/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Best Practices</a></li></ul></div><div class="col col--4 footer__col"><h4 class="footer__title">Resources</h4><ul class="footer__items"><li class="footer__item"><a href="https://redis.com/community/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community</a></li><li class="footer__item"><a href="https://university.redis.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Redis University</a></li><li class="footer__item"><a href="https://redis.io/commands" target="_blank" rel="noopener noreferrer" class="footer__link-item">Redis Commands</a></li><li class="footer__item"><a href="https://stackoverflow.com/search?q=redis" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li></ul></div></div></div></div><div class="footer__copyright">Copyright: Â© 2024 Redis. All rights reserved. Redis and the cube logo are registered trademarks of Redis Ltd.</div></div></footer></div>
<script src="/assets/js/runtime~main.bb8e0787.js"></script>
<script src="/assets/js/main.953e99e4.js"></script>
</body>
</html>